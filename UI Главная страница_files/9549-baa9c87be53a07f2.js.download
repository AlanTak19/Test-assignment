"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9549],{77791:(e,t,a)=>{a.d(t,{O:()=>n});var s=a(82226);let n=s.z.object({name:s.z.string().min(2,"Name must be at least 2 characters").max(32,"Name cannot be longer than 32 characters"),description:s.z.string().max(5e3,"Description cannot be longer than 5000 characters").optional(),instructions:s.z.string().max(5e3,"Context cannot be longer than 5000 characters").optional()})},41720:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h,useDeleteProjectModal:()=>x});var s=a(69160),n=a(18396),r=a(74693),l=a(86032);let i=(0,a(9509).$)("359d7759299d8acee7fd1108d7d36e851db00170");var o=a(31098),c=a(97077),d=a(10556),m=a(14905),u=a(98985),p=a(70934);function h(){let{isScopesReady:e,activeScopeSlug:t}=(0,u.PK)(),[a,l]=x(),h=(0,m.useRouter)(),g=(0,m.usePathname)();return e?(0,s.jsx)(r.Modal,{onOpenChange:e=>!e&&l(null),open:!!a,children:(0,s.jsxs)("form",{action:async()=>{try{let e=await i(a,t);if(!0===e)l(null),(0,d.j)("ClickDeleteProject",{targetProjectId:null!=a?a:"project-id-missing"}),c.Am.success("Project deleted"),g.startsWith("/chat/projects/".concat(a))&&h.push("/chat/projects");else throw Error(e.error)}catch(e){(0,p.R)(e)||c.Am.error("Failed to delete project")}},children:[(0,s.jsxs)(r.ModalHeader,{children:[(0,s.jsx)(r.ModalTitle,{children:"Delete Project"}),(0,s.jsxs)(r.ModalDescription,{children:["Are you sure you want to delete this project? All chats will be removed from the project, but they wonâ€™t be deleted."," ",(0,s.jsx)("span",{className:"font-medium",children:"This action cannot be reversed."})]})]}),(0,s.jsxs)(r.ModalFooter,{children:[(0,s.jsx)(r.ModalClose,{asChild:!0,children:(0,s.jsx)(n.z,{onClick:()=>l(null),size:"sm",variant:"secondary",children:"Cancel"})}),(0,s.jsx)(o.m,{"data-testid":"delete-project-button",size:"sm",variant:"destructive",children:"Delete"})]})]})}):null}function x(){let{data:e,mutate:t}=(0,l.ZP)("showDeleteProjectModal",null);return[e,t]}},31098:(e,t,a)=>{a.d(t,{m:()=>b,default:()=>j});var s=a(69160),n=a(79995),r=a(18396),l=a(36645),i=a(1370),o=a(43359),c=a(78028),d=a(9509);let m=(0,d.$)("349fa4953f998ff8053f2c5e8cd71d31a9e29cb7"),u=(0,d.$)("38c30daa40d464b21e9fc928b761de72d609aa70"),p=(0,d.$)("9bcfb761437fb7a920d8ff462326d9b9d6fa825e");var h=a(60608),x=a(66694),g=a(41720),f=a(97077),v=a(98985),y=a(70934);function j(e){var t,a,d,h;let{project:x,isAdmin:j}=e,{activeScopeSlug:N}=(0,v.PK)(),[w,k]=(0,n.useState)(x.name),[C,z]=(0,n.useState)(x.description||""),[E,Z]=(0,n.useState)((null===(t=x.settings)||void 0===t?void 0:t.instructions)||""),[I,P]=(0,n.useState)((null===(a=x.settings)||void 0===a?void 0:a.options)||""),[F,S]=(0,g.useDeleteProjectModal)(),[M,D]=(0,n.useTransition)(),R=(0,n.useCallback)(e=>{e.preventDefault(),M||D(async()=>{try{let e=await m(x.projectId,w,C,N);if(!0===e)f.Am.success("Project information updated.");else throw Error(e.error)}catch(e){(0,y.R)(e,void 0,"Failed to update project information.")||f.Am.error("Failed to update project information.")}})},[M,x.projectId,w,C,N]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(o.Zb,{children:[(0,s.jsxs)(o.Ol,{className:"p-6",children:[(0,s.jsx)(o.ll,{className:"gap-2.5 text-xl",children:"Project Information"}),(0,s.jsx)(o.SZ,{className:"text-gray-900",children:"Update your project's name and description."})]}),(0,s.jsxs)("form",{onSubmit:R,children:[(0,s.jsxs)(o.aY,{className:"grid auto-rows-min gap-4",children:[(0,s.jsxs)("div",{className:"relative grid w-full gap-2",children:[(0,s.jsx)(c.Label,{htmlFor:"projectName",children:"Project Name"}),(0,s.jsx)(l.I,{id:"projectName",onChange:e=>k(e.target.value),value:w})]}),(0,s.jsxs)("div",{className:"relative grid gap-2",children:[(0,s.jsx)(c.Label,{htmlFor:"projectDescription",children:"Description (optional)"}),(0,s.jsx)(i.g,{id:"projectDescription",onChange:e=>z(e.target.value),placeholder:"Describe what this project is for...",value:C})]})]}),(0,s.jsx)(o.eW,{className:"rounded-b-lg border-t bg-gray-100 px-6 py-4",children:(0,s.jsx)(b,{className:"ml-auto",disabled:M||w===x.name&&C===x.description,children:"Save"})})]})]}),(0,s.jsxs)(o.Zb,{children:[(0,s.jsxs)(o.Ol,{className:"p-6",children:[(0,s.jsx)(o.ll,{className:"gap-2.5 text-xl",children:"Instructions"}),(0,s.jsx)(o.SZ,{className:"text-gray-900",children:"Guidelines or instructions the model will use to generate better responses to prompts."})]}),(0,s.jsxs)("form",{action:u.bind(null,x.projectId,E,N),children:[(0,s.jsx)(o.aY,{className:"grid auto-rows-min gap-4",children:(0,s.jsxs)("div",{className:"relative grid gap-2",children:[(0,s.jsx)(c.Label,{className:"sr-only",htmlFor:"instructions",children:"Context"}),(0,s.jsx)(i.g,{id:"instructions",onChange:e=>Z(e.target.value),placeholder:"Ex: This project is using App Router, Next.js and Tailwind CSS.",value:E})]})}),(0,s.jsx)(o.eW,{className:"rounded-b-lg border-t bg-gray-100 px-6 py-4",children:(0,s.jsx)(b,{className:"ml-auto",disabled:E===(null===(d=x.settings)||void 0===d?void 0:d.instructions),children:"Save"})})]})]}),j&&(0,s.jsxs)(o.Zb,{children:[(0,s.jsxs)(o.Ol,{className:"p-6",children:[(0,s.jsx)(o.ll,{className:"gap-2.5 text-xl",children:"Advanced Options (Admin Only)"}),(0,s.jsx)(o.SZ,{className:"text-gray-900",children:"Customize the behavior of v0 using flags."})]}),(0,s.jsxs)("form",{action:p.bind(null,x.projectId,I,N),children:[(0,s.jsx)(o.aY,{className:"relative grid auto-rows-min gap-4",children:(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(c.Label,{className:"sr-only",htmlFor:"options",children:"Options"}),(0,s.jsx)(l.I,{id:"options",onChange:e=>P(e.target.value),placeholder:"stripe=1",value:I})]})}),(0,s.jsx)(o.eW,{className:"rounded-b-lg border-t bg-gray-100 px-6 py-4",children:(0,s.jsx)(b,{className:"ml-auto",disabled:I===(null===(h=x.settings)||void 0===h?void 0:h.options),children:"Save"})})]})]}),(0,s.jsxs)(o.Zb,{className:"border border-red-500",children:[(0,s.jsxs)(o.Ol,{className:"gap-2.5 p-6",children:[(0,s.jsx)(o.ll,{className:"text-xl",children:"Delete Project"}),(0,s.jsx)(o.SZ,{className:"text-gray-900",children:"The project will be permanently deleted. All chats in this project will also be deleted. This action is irreversible and can not be undone."})]}),(0,s.jsx)(o.eW,{className:"rounded-b-lg border-t border-red-500 bg-red-100 px-6 py-4",children:(0,s.jsx)(r.z,{className:"ml-auto",onClick:()=>{S(x.projectId)},size:"sm",variant:"destructive",children:"Delete Project"})})]})]})}function b(e){let{children:t,...a}=e,{pending:n}=(0,h.useFormStatus)();return(0,s.jsx)(r.z,{...a,disabled:a.disabled||n,size:"sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[n?(0,s.jsx)(x.$,{size:16}):null,t]})})}},53094:(e,t,a)=>{a.r(t),a.d(t,{SWRDataProvider:()=>i});var s=a(69160),n=a(79995),r=a(58604),l=a(86032);function i(e){let{children:t,data:a}=e,{mutate:i}=(0,r.kY)(),o=(0,n.useRef)({});(0,n.useEffect)(()=>{for(let e in a)a[e]!==o.current[e]&&i(e,Promise.resolve(a[e]),!1);o.current=a},[a,i]);let c=(0,n.useRef)(a);return(0,s.jsx)(l.J$,{value:{fallback:c.current},children:t})}},15317:(e,t,a)=>{a.d(t,{b:()=>l});var s=a(30758),n=a(86032);let r={attachmentMaxSizeBytes:3932160,contextWindow:199999,image:s.EE.default};function l(){let{data:e}=(0,n.ZP)("model-config");return null!=e?e:r}},1973:(e,t,a)=>{a.d(t,{k:()=>p,s:()=>u});var s=a(69160),n=a(79995),r=a(18396),l=a(20419),i=a(23390),o=a(45490),c=a(97077),d=a(66694),m=a(41003);let u="v0-chat-export";function p(){let[e,t]=(0,n.useTransition)(),{chatId:a}=(0,l.ae)();return(0,s.jsxs)(r.z,{disabled:e,onClick:()=>{t(async()=>{if(!a){c.Am.error("Chat ID not found.");return}try{let e=await (0,i.g)({payload:{chatId:a}});if("error"in e)throw Error(e.error);let t=new Blob([JSON.stringify(e.data)],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download="".concat(u,"-").concat(a,"-").concat(new Date().toISOString(),".json"),n.click(),URL.revokeObjectURL(s)}catch(e){(0,o.X)(e)||c.Am.error("Something went wrong. Please try again.")}})},size:"sm",tooltip:{side:"bottom",content:"Export chat (AI Team only)"},variant:"ghost",children:[e?(0,s.jsx)(d.$,{}):(0,s.jsx)(m.Z,{}),(0,s.jsx)("span",{className:"sr-only",children:"Export chat"})]})}},73119:(e,t,a)=>{a.r(t),a.d(t,{IconPickerIcon:()=>ea,getIconPickerIcon:()=>et,iconPickerIcons:()=>ee});var s=a(69160),n=a(45519),r=a(94336),l=a(33241),i=a(57663),o=a(11235),c=a(65148),d=a(88345),m=a(31304),u=a(97334),p=a(75647),h=a(30637),x=a(33445),g=a(60584),f=a(55312),v=a(71692),y=a(789),j=a(70811),b=a(58530),N=a(56892),w=a(83973),k=a(68919),C=a(94181),z=a(17393),E=a(1588),Z=a(56270),I=a(19931),P=a(48507),F=a(77626),S=a(95377),M=a(54723),D=a(43075),R=a(32871),L=a(3523),A=a(94941),T=a(75078),O=a(18288),Y=a(79398),H=a(42444),U=a(72469),B=a(1899),W=a(4751),q=a(49900),V=a(52843),$=a(82466),_=a(6022),G=a(80981),X=a(30785),Q=a(80601),K=a(18857),J=a(81355);let ee=[{name:"icon-alarm-clock",display:n.Z,tags:["alarm","clock","time"]},{name:"icon-apple",display:r.Z,tags:["apple","fruit","brand"]},{name:"icon-app-window-mac",display:l.Z,tags:["app","window","mac"]},{name:"icon-atom",display:i.Z,tags:["atom","science","molecule"]},{name:"icon-bar-chart",display:o.Z,tags:["bar-chart","data","analytics"]},{name:"icon-blocks",display:c.Z,tags:["blocks","building","structure"]},{name:"icon-book-text",display:d.Z,tags:["book","text","reading"]},{name:"icon-briefcase",display:m.Z,tags:["briefcase","work","portfolio"]},{name:"icon-bug",display:u.Z,tags:["bug","issue","error"]},{name:"icon-calendar",display:p.Z,tags:["calendar","date","event"]},{name:"icon-camera",display:h.Z,tags:["camera","photo","picture"]},{name:"icon-code",display:x.Z,tags:["code","development","programming"]},{name:"icon-fingerprint",display:g.Z,tags:["fingerprint","security","authentication"]},{name:"icon-flame",display:f.Z,tags:["flame","fire","heat"]},{name:"icon-flask-conical",display:v.Z,tags:["flask","science","experiment"]},{name:"icon-folder-closed",display:y.Z,tags:["folder","closed","directory"]},{name:"icon-gamepad",display:j.Z,tags:["gamepad","gaming","controller"]},{name:"icon-github",display:b.Z,tags:["github","code","repository"]},{name:"icon-gitlab",display:N.Z,tags:["gitlab","code","repository"]},{name:"icon-globe",display:w.Z,tags:["globe","world","internet"]},{name:"icon-heart",display:k.Z,tags:["heart","love","favorite"]},{name:"icon-home",display:C.Z,tags:["home","house","dashboard"]},{name:"icon-image",display:z.Z,tags:["image","picture","photo"]},{name:"icon-key-square",display:E.Z,tags:["key","security","access"]},{name:"icon-laptop",display:Z.Z,tags:["laptop","computer","device"]},{name:"icon-layers",display:I.Z,tags:["layers","stack","structure"]},{name:"icon-lightbulb",display:P.Z,tags:["lightbulb","idea","innovation"]},{name:"icon-link",display:F.Z,tags:["link","connection","hyperlink"]},{name:"icon-lock",display:S.Z,tags:["lock","security","protection"]},{name:"icon-mail",display:M.Z,tags:["mail","email","communication"]},{name:"icon-message-square-text",display:D.Z,tags:["message","text","chat"]},{name:"icon-palette",display:R.Z,tags:["palette","color","art"]},{name:"icon-paint-roller",display:L.Z,tags:["paint","roller","art"]},{name:"icon-pie-chart",display:A.Z,tags:["pie-chart","data","analytics"]},{name:"icon-rocket",display:T.Z,tags:["rocket","launch","space"]},{name:"icon-scroll-text",display:O.Z,tags:["scroll","text","document"]},{name:"icon-settings",display:Y.Z,tags:["settings","gear","preferences"]},{name:"icon-shield-check",display:H.Z,tags:["shield","check","security"]},{name:"icon-smartphone",display:U.Z,tags:["smartphone","mobile","device"]},{name:"icon-siren",display:B.Z,tags:["siren","alert","alarm"]},{name:"icon-sprout",display:W.Z,tags:["sprout","growth","nature"]},{name:"icon-square-function",display:q.Z,tags:["function","math","calculation"]},{name:"icon-traffic-cone",display:V.Z,tags:["traffic","cone","warning"]},{name:"icon-trending-down",display:$.Z,tags:["trending-down","decrease","statistics"]},{name:"icon-trending-up",display:_.Z,tags:["trending-up","increase","statistics"]},{name:"icon-trophy",display:G.Z,tags:["trophy","award","achievement"]},{name:"icon-user",display:X.Z,tags:["user","person","profile"]},{name:"icon-wand-sparkles",display:Q.Z,tags:["wand","magic","sparkles"]},{name:"icon-wrench",display:K.Z,tags:["wrench","tool","repair"]},{name:"icon-zap",display:J.Z,tags:["zap","lightning","electricity"]}];function et(e){var t;return(null===(t=ee.find(t=>t.name===e))||void 0===t?void 0:t.display)||ee[0].display}function ea(e){let{name:t}=e,a=et(t);return(0,s.jsx)(a,{})}},8241:(e,t,a)=>{a.d(t,{NewProjectButton:()=>C,default:()=>z});var s=a(69160),n=a(79995),r=a(18396),l=a(36645),i=a(1370),o=a(78028),c=a(86032),d=a(69512),m=a(74693),u=a(31098),p=a(14905),h=a(65317),x=a(59700),g=a(77791),f=a(85061),v=a(48531),y=a(29922),j=a(20900),b=a(24815),N=a(60121),w=a(21930),k=a(98985);function C(e){let{variant:t,onAfterClick:a,className:n,hasAccess:l,...i}=e,{setUpgradePromptOpen:o}=(0,j._)(),c=(0,b.N)("project.createDialog"),{activeScope:d,user:m}=(0,k.PK)(),{planSlug:u}=(0,N.Y)(!0,null==d?void 0:d.id),p="v0-level0"!==u||(null==m?void 0:m.isV0Admin)||(null==m?void 0:m.isVercelian);return l||void 0!==u?l||p?(0,s.jsx)(r.z,{className:(0,x.cn)(n),size:"sm",variant:t,...i,asChild:!0,children:(0,s.jsx)(v.default,{className:(0,x.cn)(n),href:"/chat/projects/new",onClick:a,children:c("newProjectButton")})}):(0,s.jsxs)(r.z,{className:(0,x.cn)(n),"data-testid":"new-project-upgrade-button",onClick:()=>{o(!0),null==a||a()},size:"sm",type:"button",children:[(0,s.jsx)(y.B,{}),c("upgradePlan")]}):(0,s.jsx)(w.O,{className:(0,x.cn)("h-8",n)})}function z(){let[e,t]=function(){let{data:e,mutate:t}=(0,c.ZP)("showNewProjectDialog",null,{fallbackData:!1});return[e,t]}(),[a,v]=(0,n.useState)(),[y,j]=(0,n.useState)(""),[b,N]=(0,n.useState)(""),[w,C]=(0,n.useState)(""),z=(0,p.useRouter)(),[E,Z]=(0,n.useState)(!1),{activeScopeSlug:I}=(0,k.PK)(),P=(0,n.useCallback)(()=>{j(""),N(""),C(""),v(void 0)},[]);return(0,n.useEffect)(()=>{e&&P()},[e,P]),(0,s.jsx)(m.Modal,{onOpenChange:e=>{E||t(e)},open:e,children:(0,s.jsxs)("form",{action:async()=>{Z(!0);let e=g.O.safeParse({name:y,description:b,instructions:w});if(!e.success){v(e.error.flatten().fieldErrors),Z(!1);return}try{let{id:e,errors:a,success:s}=await (0,d.m)({name:y,description:b,instructions:w,scopeSlug:I});if(a){v(a),Z(!1);return}s&&e?(z.push("/chat/projects/".concat(e)),t(!1)):v({name:["Failed to create project. Please try again."]})}catch(e){console.error("Failed to create project:",e),v({name:["An unexpected error occurred. Please try again."]})}finally{Z(!1)}},autoComplete:"off",children:[(0,s.jsxs)(m.ModalHeader,{className:"px-6",children:[(0,s.jsx)(m.ModalTitle,{children:"New Project"}),(0,s.jsx)(m.ModalDescription,{children:"Use projects as a way to organize and share chats. You can also link and upload resources like files and code. Soon, you will be able to connect Vercel Projects and Git Repositories."})]}),(0,s.jsxs)(m.ModalContent,{className:"grid gap-6 px-4 sm:px-6",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsxs)(o.Label,{className:(0,x.cn)((null==a?void 0:a.name)&&"text-red-500"),htmlFor:"name",children:["Project Name",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(l.I,{autoComplete:"off",className:(0,x.cn)((null==a?void 0:a.name)&&"border-red-500"),id:"name",maxLength:32,minLength:2,name:"name",onChange:e=>j(e.target.value),placeholder:"New sidebar",required:!0,value:y}),(null==a?void 0:a.name)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:a.name[0]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(o.Label,{className:(0,x.cn)((null==a?void 0:a.description)&&"text-red-500"),htmlFor:"description",children:"Description (optional)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.g,{autoComplete:"off",className:(0,x.cn)("min-h-[120px] pb-8",(null==a?void 0:a.description)&&"border-red-500"),id:"description",maxLength:5e3,name:"description",onChange:e=>N(e.target.value),placeholder:"Describe what this project is going to be used for...",value:b}),(0,s.jsx)(f.l,{className:"absolute inset-x-1 bottom-2.5",count:b.length,max:5e3,message:"Description cannot be longer than 500 characters",messageThreshold:5e3})]}),(null==a?void 0:a.description)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:a.description[0]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsxs)(o.Label,{className:(0,x.cn)("flex items-center gap-2",(null==a?void 0:a.instructions)&&"text-red-500"),htmlFor:"instructions",children:["Context (optional)",(0,s.jsx)(h.Tooltip,{content:"The model will use the provided context for every chat created in this project",children:(0,s.jsx)("span",{children:(0,s.jsxs)("svg",{height:"16",strokeLinejoin:"round",viewBox:"0 0 16 16",width:"16",children:[(0,s.jsx)("path",{className:"fill-gray-200",d:"M14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8Z"}),(0,s.jsx)("path",{clipRule:"evenodd",d:"M8 6C8.55228 6 9 5.55228 9 5C9 4.44772 8.55228 4 8 4C7.44771 4 7 4.44772 7 5C7 5.55228 7.44771 6 8 6ZM7 7H6.25V8.5H7H7.24999V10.5V11.25H8.74999V10.5V8C8.74999 7.44772 8.30227 7 7.74999 7H7Z",fill:"currentColor",fillRule:"evenodd"})]})})})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.g,{autoComplete:"off",className:(0,x.cn)("min-h-[120px] pb-8",(null==a?void 0:a.instructions)&&"border-red-500"),id:"instructions",maxLength:5e3,name:"instructions",onChange:e=>C(e.target.value),placeholder:"We're building a new sidebar for...",value:w}),(0,s.jsx)(f.l,{className:"absolute inset-x-1 bottom-2.5",count:w.length,max:5e3,message:"For larger context, consider using sources on the project page.",messageThreshold:5e3})]}),(null==a?void 0:a.instructions)&&(0,s.jsx)("p",{className:"text-xs text-red-500",children:a.instructions[0]})]})]}),(0,s.jsxs)(m.ModalFooter,{className:"px-4 sm:px-6",children:[(0,s.jsx)(m.ModalClose,{asChild:!0,children:(0,s.jsx)(r.z,{disabled:E,size:"sm",type:"button",variant:"secondary",children:"Cancel"})}),(0,s.jsx)(u.m,{disabled:E,size:"sm",type:"submit",children:"Create Project"})]})]})})}},1996:(e,t,a)=>{a.d(t,{Q:()=>j});var s=a(69160),n=a(79995),r=a(55347),l=a(95302),i=a(18396),o=a(8241),c=a(49444),d=a(59667),m=a(80729),u=a(59700),p=a(74693),h=a(19773),x=a(10556),g=a(24815),f=a(73119),v=a(97563);function y(e){let{onClose:t}=e,a=(0,g.N)("project.dropdown");return(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-1 sm:p-2",children:(0,s.jsx)(m.HY,{className:"bg-muted w-full rounded-md border border-gray-200 p-2",children:(0,s.jsxs)(m.z1,{className:"flex flex-col items-center space-y-4 p-4",children:[(0,s.jsxs)("span",{className:"flex flex-col items-center justify-between space-y-4",children:[(0,s.jsx)(m.tL,{className:"bg-background mx-auto text-gray-400",children:(0,s.jsx)(c.V,{})}),(0,s.jsxs)("span",{className:"flex flex-col items-center space-y-2",children:[(0,s.jsx)(m.Er,{children:a("noProjects")}),(0,s.jsx)(m.T1,{className:"text-balance text-center text-gray-400",children:a("createProject")})]})]}),(0,s.jsx)(o.NewProjectButton,{onAfterClick:t})]})})})}function j(e){let{disabled:t,triggerButton:a,handleProjectSelect:c}=e,{projects:m,selectedProjectId:j,setSelectedProjectId:b}=(0,h.Gb)(),[N,w]=(0,n.useState)(!1),[k,C]=(0,n.useState)(!1),z=(0,v.dD)(),E=(0,g.N)("project"),Z=()=>{w(!1),C(!1)},I=e=>{b((null==e?void 0:e.projectId)||null),Z(),(0,x.j)("SelectProject",{projectId:(null==e?void 0:e.projectId)||null}),null==c||c(e?{projectId:e.projectId,name:e.name,settings:{icon:e.icon||void 0,color:e.color||void 0}}:null)},P=j&&m.find(e=>e.projectId===j),F=a||(0,s.jsx)(i.z,{"aria-label":"Select project",className:(0,u.cn)("flex min-w-20 max-w-[200px] justify-start pl-1.5 transition-colors has-[>svg]:pr-3",{"border-dashed text-gray-500":!P}),disabled:t,size:"sm",variant:"secondary",children:P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.IconPickerIcon,{name:P.icon}),(0,s.jsx)("span",{className:"truncate",children:P.name})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.v,{className:"size-4 shrink-0"}),E("project")]})}),S=(0,s.jsxs)("div",{className:"p-1",children:[(0,s.jsx)("div",{className:"max-h-[400px] space-y-2 overflow-y-auto text-left",children:m.map(e=>(0,s.jsxs)("button",{className:"flex w-full items-center justify-between rounded-md px-2 py-2.5 hover:bg-gray-100",onClick:()=>I(j===e.projectId?null:e),children:[(0,s.jsxs)("span",{className:"flex min-w-0 flex-1 items-center",children:[(0,s.jsx)("div",{className:"[&>svg]:size-4",children:(0,s.jsx)(f.IconPickerIcon,{name:e.icon})}),(0,s.jsx)("span",{className:"ml-2 max-w-[200px] truncate",children:e.name})]}),j===e.projectId?(0,s.jsxs)("span",{className:"flex shrink-0 items-center text-gray-500",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4 group-hover:hidden"}),(0,s.jsx)("span",{className:"hidden group-hover:inline",children:E("dropdown.unselect")})]}):(0,s.jsx)("span",{className:"hidden shrink-0 text-gray-500 group-hover:inline",children:E("dropdown.select")})]},e.projectId))}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(o.NewProjectButton,{className:"w-full",onAfterClick:Z,size:"sm",variant:"secondary"})})]}),M=0===m.length?(0,s.jsx)(y,{onClose:Z}):S;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-full md:hidden",children:(0,s.jsx)(p.Modal,{onOpenChange:w,open:N&&z,trigger:F,children:(0,s.jsx)(p.ModalContent,{className:(0,u.cn)("max-h-[80vh]",{"overflow-y-auto":m.length>0}),children:M})})}),(0,s.jsx)("div",{className:"hidden w-full md:block",children:(0,s.jsxs)(r.h_,{onOpenChange:C,open:k&&!z,children:[(0,s.jsx)(r.$F,{asChild:!0,className:"max-w-[200px]",children:F}),(0,s.jsx)(r.AW,{align:"start",className:(0,u.cn)("w-[350px]",{"max-h-[275px] overflow-y-auto":m.length>0}),side:"bottom",sideOffset:4,children:0===m.length?(0,s.jsx)(y,{onClose:Z}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Qk,{className:"max-h-[225px] overflow-y-auto",children:m.map(e=>(0,s.jsxs)(r.Xi,{className:"group py-2.5 pl-2 pr-3",onClick:()=>I(j===e.projectId?null:e),children:[(0,s.jsxs)("span",{className:"flex w-full max-w-[200px] items-center",children:[(0,s.jsx)("div",{className:"[&>svg]:size-4",children:(0,s.jsx)(f.IconPickerIcon,{name:e.icon})}),(0,s.jsx)("span",{className:"ml-3 min-w-0 flex-1",children:(0,s.jsx)("span",{className:"block truncate","data-testid":"project-option",children:e.name})})]}),j===e.projectId?(0,s.jsxs)("span",{className:"ml-auto flex shrink-0 items-center text-gray-500",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4 group-hover:hidden"}),(0,s.jsx)("span",{className:"hidden group-hover:inline",children:E("dropdown.unselect")})]}):(0,s.jsx)("span",{className:"ml-auto hidden shrink-0 text-gray-500 group-hover:inline",children:E("dropdown.select")})]},e.projectId))}),(0,s.jsx)(r.VD,{}),(0,s.jsx)(r.Qk,{className:"bg-muted",children:(0,s.jsx)(o.NewProjectButton,{onAfterClick:Z,size:"sm",variant:"secondary",className:"w-full"})})]})})]})})]})}},26183:(e,t,a)=>{a.d(t,{r:()=>q,R:()=>Q});var s=a(69160),n=a(30851),r=a(79995),l=a(59700),i=a(15214),o=a(68257),c=a(20419),d=a(10556),m=a(73627),u=a(60785),p=a(29922),h=a(57464),x=a(29996),g=a(30758),f=a(39929),v=a(94835),y=a(18396),j=a(19446),b=a(72409),N=a(95468),w=a(35409),k=a(85933),C=a(66694),z=a(7286),E=a(21930);a(14905);var Z=a(86032);a(74326);var I=a(80685);a(70900),a(15794),a(92019),a(48531),a(84806),a(80729),a(33949);var P=a(24815);a(96758);var F=a(76811),S=a(73884),M=a(66018),D=a(43097),R=a(1996),L=a(76891),A=a(89292),T=a(15317),O=a(59210),Y=a(10346),H=a(20900),U=a(12175),B=a(19773),W=a(88375);function q(e){let t,{submit:a,stop:m,scrollDownButton:j,isMobile:b,isNewChat:N,isHome:w,isSignedIn:k,className:C,clearOnSubmit:q=!0,placeholder:G,dragContainerRef:K,onInputChange:J,maxLength:ee,isPending:et}=e,{blobs:ea,reset:es,localFileInfos:en,removeFile:er,isDraggingFile:el,inputFileRef:ei,onInputChange:eo,uploading:ec,uploadFiles:ed}=(0,f.Z)({isSignedIn:k,dragContainerRef:K}),{initialStreamPromise:em,activeForkKey:eu,isLoading:ep,isStreaming:eh,messages:ex,isContinuing:eg}=(0,c.RN)(),{quote:ef,setQuote:ev}=(0,F.B1)(),ey=(0,r.useRef)(null),ej=(0,r.useRef)(()=>{}),{setShowSignInDialog:eb}=(0,v.p)(),{showBannerLimit:eN,showBannerGeneral:ew}=(0,M.D2)(),ek=eN&&k,eC=ew&&k,ez=ek||eC,{handleSavePromptDraft:eE,draft:eZ}=(0,D.no)(),[eI,eP]=(0,r.useState)(!0),{selectedProjectId:eF}=(0,B.Gb)(),{project:eS}=(0,F.xN)(),{user:eM,expectUser:eD}=(0,W.a)(),[eR,eL]=(0,r.useState)(()=>{var e;return(0,O.f8)((null===(e=ey.current)||void 0===e?void 0:e.value)||"")}),{tokenUsage:eA,percentage:eT,exceededCharCount:eO,onlyImageFiles:eY,onlyTextFiles:eH}=function(e){let{localFiles:t,textAreaTokens:a}=e,s=(0,T.b)(),{messages:n}=(0,c.RN)(),l=(0,r.useMemo)(()=>t.reduce((e,t)=>e+(t.tokens||0),0),[t]),i=(0,r.useMemo)(()=>(0,A.N)(n),[n]),o=(0,r.useMemo)(()=>i+l+a,[i,l,a]),d=t.every(e=>e.isImage),m=t.every(e=>void 0!==e.content),u=(0,r.useMemo)(()=>{if(o<=s.contextWindow)return 0;let e=o-s.contextWindow;return(0,O.Yd)(e)},[o,s.contextWindow]);return{total:s.contextWindow,used:o,available:s.contextWindow-o,percentage:Math.round(o/s.contextWindow*100),onlyImageFiles:d,onlyTextFiles:m,exceededCharCount:u,tokenUsage:i}}({localFiles:en,textAreaTokens:eR}),eU=eT>100,eB=(0,r.useMemo)(()=>{var e;return null===(e=function(e,t){for(let a=e.length-1;a>=0;a--)if(t(e[a]))return e[a]}(ex,e=>"user"===e.role))||void 0===e?void 0:e.content},[ex]),eW=(0,c.RN)().chatId,eq=(0,r.useCallback)(()=>{var e,t;let a=(null===(e=ey.current)||void 0===e?void 0:e.value)||"";eP(!a),null==J||J(a),eL((0,O.f8)(a)),eE({message:a,inputHeight:(null===(t=ey.current)||void 0===t?void 0:t.style.height)?parseInt(ey.current.style.height):void 0})},[eE,J]),[eV]=(0,M.Uf)(),e$=(null==eV?void 0:eV.remaining)===0,e_=ep||eh||et,eG=eI&&0===en.length&&!(null==eZ?void 0:eZ.message),eX=e_||ec||eG||e$||eU||eD&&!eM;(0,r.useEffect)(()=>{eX&&eq()},[]);let eQ=en.length>0,[eK,eJ]=(0,r.useState)(!1),{showHistoryPopover:e0}=function(){let{revalidate:e}=(0,I.v)(),{data:t,mutate:a}=(0,Z.ZP)("showHistoryPopover",null,{fallbackData:!1});return{showHistoryPopover:t,setShowHistoryPopover:(0,r.useCallback)(t=>{e(),a(t)},[a,e])}}(),[e1]=(0,z.Zw)(),e9=(0,z.VD)(),{promptFormInput:e5,setPromptFormInput:e2}=Q();(0,r.useEffect)(()=>{if(!ey.current||void 0===e5)return;let e=ey.current;e.value=e.value?"".concat(e.value,"\n").concat(e5):e5,e2(void 0),e.style.height="".concat(e.scrollHeight,"px"),e.focus(),eq()},[e5,e2,eq]),(null==eZ?void 0:eZ.source)!=="cookie"||eZ.isMessageTrimmed||(t=eZ.message);let e3=(null==eZ?void 0:eZ.source)==="cookie"&&eZ.isMessageTrimmed;(0,r.useEffect)(()=>{if("string"==typeof(null==eZ?void 0:eZ.message)&&"localStorage"===eZ.source&&eZ.message&&ey.current){if(ey.current.value!==eZ.message&&!eZ.isExpandedDraft){eq();return}let e=ey.current;e.value=eZ.message,e.style.height="".concat(eZ.inputHeight,"px"),e.scrollTop=1e7,e.focus(),e.setSelectionRange(eZ.message.length,eZ.message.length),eZ.quote&&ev(eZ.quote),eL((0,O.f8)(eZ.message+eZ.quote))}},[e2,eZ,eq,ev]);let{position:e4}=e1,e7=!1!==e1.isAllowed;(0,r.useEffect)(()=>{let e=ey.current;e&&en.length>0&&e.focus()},[en]),(0,r.useEffect)(()=>{let e=ey.current;if(!e)return;let t=t=>{"/"!==t.key||t.target&&(["INPUT","TEXTAREA"].includes(t.target.nodeName)||"contentEditable"in t.target&&"true"===t.target.contentEditable)||(t.preventDefault(),t.stopPropagation(),e.focus())},a=e=>{"Escape"===e.key&&e_&&(e.preventDefault(),e.stopPropagation(),m())},s=t=>{"Escape"===t.key&&""===e.value.trim()&&ev(null)},n=t=>{N||e_||"ArrowUp"!==t.key||""!==e.value.trim()||!eB||(0,r.startTransition)(()=>{e.value=String(eB),requestAnimationFrame(()=>e.select())})};return document.addEventListener("keydown",t),document.addEventListener("keydown",a),e.addEventListener("keydown",n),e.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",a),document.removeEventListener("keydown",t),e.removeEventListener("keydown",n),e.removeEventListener("keydown",s)}},[m,eB,N,e_,ev]);let e6=(0,P.N)("promptForm"),e8=(0,r.useCallback)(e=>{var t,s;if(e&&e.preventDefault(),e_)return;let n=(null===(t=ey.current)||void 0===t?void 0:t.value.trim())||"";(n||0!==en.length)&&(a({action:"new",input:n,attachments:ea}),(0,d.j)("SubmitNewUserMessage",{text:n,index:ex.length,imageOnly:en.length>0&&""===n.trim(),projectId:N?eF:null!==(s=null==eS?void 0:eS.projectId)&&void 0!==s?s:null}),q&&k&&(es(),ey.current&&(ey.current.value="",ej.current()),eP(!0)))},[e_,en.length,a,ea,ex.length,N,eF,null==eS?void 0:eS.projectId,q,k,es]),{formRef:te,onKeyDown:tt}=(0,n.h)({localFileInfos:en,submitMessage:e8});(0,r.useEffect)(()=>{ef&&te.current&&te.current.content&&te.current.content.focus()},[te,ef]);let ta=(0,r.useCallback)(e=>{b||eX||tt(e)},[b,eX,tt]),ts=k&&e9&&!e7,tn=!N&&!ts,tr=ex[ex.length-1],tl=tr&&Array.isArray(tr.content)&&tr.content.some(e=>!!Array.isArray(e)&&0===e[0]),ti=(0,r.useMemo)(()=>{let e=(0,L.BT)(g.jZ?g.qf.maxSizeBytes:g.EE.default.maxSizeBytes);return(0,s.jsxs)("span",{children:[e6("attachFiles"),"  ",(0,s.jsx)("span",{className:"text-gray-400",children:e6("maxEach",g.Vr["prompt-attachment"],e)})]})},[]),{setUpgradePromptOpen:to}=(0,H._)();return(0,s.jsx)("div",{className:(0,l.cn)("notranslate sticky inset-x-0 bottom-0 flex items-center",C),children:(0,s.jsxs)("div",{className:(0,l.cn)("relative z-10 flex w-full flex-col",!N&&"bg-background mx-auto max-w-3xl px-2 pb-2 sm:px-3 sm:pb-3 md:px-4 md:pb-4",tn&&"pb-0 sm:pb-0 md:pb-0"),children:[(0,s.jsx)(i.M,{mode:"sync",children:ez?(0,s.jsx)(o.E.div,{animate:{opacity:1,height:"auto"},className:"relative rounded-t-xl bg-gray-100 text-gray-600",exit:{opacity:0,height:0},initial:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)(M.hx,{almostAtLimit:ek})},"rate-limit"):null}),(0,s.jsx)("div",{className:(0,l.cn)(ez&&"bg-gray-100","rounded-b-xl"),children:(0,s.jsxs)("form",{className:(0,l.cn)("focus-within:border-alpha-600 border-alpha-400 bg-background-subtle relative rounded-xl border transition-colors"),onSubmit:e8,ref:te,children:[(0,s.jsx)(X,{message:ex.find(e=>!!(eu&&eu[eu.length-1]===e.id)),isContinuing:eg,isLoading:ep,isStreaming:eh}),N?null:j,(0,s.jsxs)(i.M,{mode:"sync",children:[ef?(0,s.jsx)(o.E.div,{animate:{opacity:1,height:"auto"},className:"bg-muted relative rounded-t-xl border-b text-gray-600",exit:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:(0,s.jsx)($,{className:(0,l.cn)(eQ&&"pb-1"),onClose:()=>void ev(null),quote:ef,shouldNotAnimate:(null==eZ?void 0:eZ.quote)===ef},"quote-component-".concat(ef))},"quote-animate-".concat(ef)):null,eQ||el?(0,s.jsxs)(o.E.div,{animate:{opacity:1,height:"auto"},className:"bg-muted relative rounded-t-xl text-gray-600",exit:{opacity:0,height:0},initial:((null==eZ?void 0:eZ.localFileInfos.length)||0)>0?{opacity:1,height:"auto"}:{opacity:0,height:0},transition:{type:"spring",damping:20,stiffness:300,mass:.2},children:[(0,s.jsx)(_,{files:en,removeFile:er,showDropzone:el}),eT>80?(0,s.jsxs)("p",{className:(0,l.cn)("flex items-center gap-1 p-3 pt-0 text-xs text-gray-600",eU?"text-red-700":"text-gray-600"),children:[(0,s.jsx)(Y.b,{className:"size-3.5"}),function(e){let{exceedsContextWindow:t,isNewChat:a,onlyTextFiles:s,onlyImageFiles:n,exceededCharCount:r,tokenUsage:l}=e,i="Your message and attachment(s) ".concat(t?"exceed":"are close to exceeding"," ").concat(a?"the chat context window":"the context window for this chat");return s&&t?i+=" by an estimated ".concat(r," character").concat(1===r?"":"s","."):i+=".",l>5e4&&!a?i+=" Try starting a new chat.":n?i+=" Try resizing or removing attached images.":s?i+=" Try uploading smaller snippet(s) of your attachment(s).":i+=" Try reducing the size of your attachment(s).",i}({exceedsContextWindow:eU,isNewChat:N,onlyTextFiles:eH,onlyImageFiles:eY,exceededCharCount:eO,tokenUsage:eA})]}):null]},"attachments-".concat(el,"-").concat(en.length)):null]}),(0,s.jsxs)("div",{className:(0,l.cn)("@container/textarea bg-background-subtle relative z-10 grid rounded-xl",ts&&"cursor-not-allowed bg-gray-100 text-gray-400"),children:[(0,s.jsx)("label",{className:"sr-only",htmlFor:"chat-main-textarea",children:e6("chatInput")}),e3&&eZ.inputHeight?(0,s.jsx)("div",{className:"flex w-full flex-col gap-0 px-3",style:{height:"".concat(eZ.inputHeight,"px")},children:Array.from({length:Math.floor((eZ.inputHeight-12)/20)}).map((e,t)=>(0,s.jsx)("div",{className:(0,l.cn)("flex h-5 items-center justify-center",0===t?"mt-3":""),style:{width:"".concat([45,35,50,60,42,70,48][t%7],"%")},children:(0,s.jsx)(E.O,{className:"h-3 w-full"},t)},"prompt-skeleton-"+t))}):(0,s.jsx)(S.P,{resizeFunctionRef:ej,autoFocus:!b&&!e0,className:(0,l.cn)("w-full flex-1 bg-transparent p-3 pb-1.5 text-sm outline-none ring-0 placeholder:text-gray-500",ts&&"@[570px]/textarea:!min-h-fit !min-h-[54px] cursor-not-allowed text-gray-500"),defaultValue:t,disabled:ts||e$,id:"chat-main-textarea",maxLength:ee,name:"content",onChange:eq,onKeyDown:ta,onPaste:e=>{let t=e.clipboardData.getData("text");if(!t)return;let a=t.split("\n").length,s=t.length;(a>200||s>2e4)&&(e.preventDefault(),ed([new File([new Blob([t],{type:"text/plain"})],"snippet.txt",{type:"text/plain"})]))},placeholder:ts?"".concat(e6("youAreInQueue"),": ").concat(Number(e4)+1):e$?(()=>{if(!eV||!eV.reset)return"";let e=new Date(eV.reset),t=(0,U.WU)(e,"h:mm a");return b?"Message limit resets at ".concat(t,"."):"You are out of messages - your limit will reset at ".concat(t,". Upgrade your plan to increase limits.")})():G||(N?e6("askQuestion"):e6("askFollowup")),ref:ey,style:{height:void 0!==t&&(null==eZ?void 0:eZ.inputHeight)?"".concat(eZ.inputHeight,"px"):"42px",caretColor:t?"transparent":void 0}},eW),(0,s.jsxs)(V,{className:"p-3",children:[k?(0,s.jsx)(y.z,{asChild:!0,className:(0,l.cn)("focus:bg-muted size-8 hover:bg-gray-100 focus-visible:bg-gray-100",(e_||ts||e$)&&"pointer-events-none bg-gray-100 text-gray-400 ring-0"),disabled:e_||e$,size:"sm",tooltip:{content:ti,hidden:eK},variant:"secondary",children:(0,s.jsxs)("label",{"data-id":"prompt-form-image-upload",htmlFor:"fileUpload",children:[(0,s.jsx)("input",{className:"sr-only","data-enable-grammarly":"false","data-gramm":"false","data-gramm_editor":"false",disabled:e_||e$,id:"fileUpload",multiple:!0,onChange:e=>{var t,a;eJ(!0),eo(e),null===(t=ey.current)||void 0===t||t.focus(),(0,d.j)("AttachFiles",{count:null===(a=e.target.files)||void 0===a?void 0:a.length,fileNames:Array.from(e.target.files||[]).map(e=>e.name)})},ref:ei,tabIndex:e_?-1:0,type:"file"}),(0,s.jsx)(h.p,{}),(0,s.jsx)("span",{className:"sr-only",children:e6("attachFiles")})]})}):(0,s.jsxs)(y.z,{className:"size-8",disabled:e_||e$,onClick:()=>{var e;eb({prompt:(null===(e=ey.current)||void 0===e?void 0:e.value)||""})},size:"sm",tooltip:e6("attachFiles"),variant:"secondary",children:[(0,s.jsx)(h.p,{}),(0,s.jsx)("span",{className:"sr-only",children:e6("attachFiles")})]}),w&&(0,s.jsx)("div",{className:"shrink-1 min-w-0 grow-0",children:(0,s.jsx)(R.Q,{disabled:ts||e$})}),(0,s.jsx)("div",{className:"ml-auto flex items-center gap-2",children:e_?(0,s.jsxs)(y.z,{className:"ml-auto shrink-0",disabled:void 0!==em||ep||et||!tl,onClick:e=>{e.preventDefault(),m()},size:"sm",type:"button",children:[(0,s.jsx)(x.P,{})," ",e6("stop"),(0,s.jsx)("span",{className:"sr-only",children:e6("stopGeneration")})]}):e$?(0,s.jsxs)(y.z,{"data-testid":"prompt-form-upgrade-button",onClick:()=>to(!0),size:"sm",type:"button",children:[(0,s.jsx)(p.B,{}),e6("upgradePlan")]}):(0,s.jsxs)(y.z,{"data-testid":"prompt-form-send-button",disabled:eX,size:"sm",type:"submit",children:[(0,s.jsx)(u.a,{}),(0,s.jsx)("span",{className:"sr-only",children:e6("sendMessage")})]})})]})]})]})}),tn?(0,s.jsx)("p",{className:"py-2 text-center text-xs text-gray-500",children:e6("disclaimer")}):null]})})}function V(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)("flex items-center gap-2",t),...a})}function $(e){let{quote:t,onClose:a,className:n,shouldNotAnimate:r}=e,i=(0,P.N)("promptForm");return(0,s.jsx)("div",{className:(0,l.cn)("p-3",n),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-1 shrink-0 self-stretch rounded-full bg-gray-300"}),(0,s.jsx)("div",{className:(0,l.cn)(r?"":"mask-animation","line-clamp-2 flex-1 whitespace-pre-wrap text-sm text-gray-600"),title:t,children:t},"quote-".concat(r)),(0,s.jsxs)(y.z,{className:"m-[3px]",onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:i("removeQuote"),variant:"secondary",children:[(0,s.jsx)(j.X,{}),(0,s.jsx)("span",{className:"sr-only",children:i("remove")})]})]})})}function _(e){let{files:t,removeFile:a,showDropzone:n}=e,r=(0,P.N)("promptForm");return(0,s.jsxs)("div",{className:"no-scrollbar h-16 overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 p-3 transition-opacity",style:{opacity:n?1:0,pointerEvents:n?"auto":"none"},children:(0,s.jsx)("div",{className:"flex h-10 flex-col items-center justify-center gap-1 rounded-md border border-dashed border-gray-300 p-3 text-center text-xs text-gray-400",children:(0,s.jsxs)("div",{className:"flex items-center gap-1 font-medium text-gray-500",children:[(0,s.jsx)(N.F,{className:"size-3.5"})," ",r("dropFilesHere")]})})}),t.length?(0,s.jsx)("div",{className:"flex items-center gap-3 overflow-x-auto p-3 transition-opacity",style:{opacity:n?0:1},children:t.slice().reverse().map(e=>(0,s.jsx)(G,{file:e,onRemoveButtonClicked:()=>a(e.id)},e.id))}):null]})}function G(e){let{file:t,onRemoveButtonClicked:a,className:n}=e,i="uploading"===t.status,[o,c]=(0,r.useState)(!i&&!t.isSavedDraft),d=(0,l.yr)(t.name,18),m=(0,P.N)("promptForm"),u=(0,s.jsx)(y.z,{asChild:!0,className:"w-full gap-1 py-1 pl-1 pr-3 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100",variant:"secondary",children:(0,s.jsxs)("div",{tabIndex:0,children:[(0,s.jsx)("div",{className:"flex size-8 shrink-0 -translate-x-px items-center justify-center overflow-hidden rounded-sm bg-gray-100 text-gray-500",children:i?(0,s.jsx)(C.$,{size:16}):t.isImage?(0,s.jsx)(k.default,{alt:t.name,className:"border-alpha-400 aspect-square rounded-sm border object-cover",fill:!0,src:t.url}):(0,s.jsx)(b.$,{})}),(0,s.jsxs)("div",{className:"grid flex-1 gap-1 py-0.5 text-xs leading-none text-gray-500",children:[(0,s.jsx)("div",{className:"overflow-hidden text-ellipsis font-medium",children:d}),(0,s.jsx)("div",{className:"line-clamp-1 font-normal",children:i?m("uploading"):(0,l.sS)(t.size)})]})]})});return(0,s.jsxs)("div",{className:(0,l.cn)("relative h-10 w-[150px] shrink-0",n),children:[t.isImage?(0,s.jsxs)(w.zs,{closeDelay:0,onOpenChange:c,open:o,openDelay:0,children:[(0,s.jsx)(w.Yi,{asChild:!0,children:u}),(0,s.jsx)(w.bZ,{className:"text-muted max-h-[300px] overflow-auto rounded-xl bg-black p-1 text-xs",side:"top",sideOffset:8,children:(0,s.jsx)(k.default,{alt:t.name,className:"aspect-video rounded-lg object-cover",height:300,src:t.url,width:530})})]},t.id):u,(0,s.jsxs)(y.z,{className:(0,l.cn)("absolute right-0 top-0 -translate-y-1/3 translate-x-1/3 hover:bg-gray-100 focus:bg-gray-100 focus-visible:bg-gray-100",i&&"invisible"),onClick:e=>{e.preventDefault(),a()},rounded:!0,size:"tiny",tooltip:m("remove"),variant:"secondary",children:[(0,s.jsx)(j.X,{}),(0,s.jsx)("span",{className:"sr-only",children:m("remove")})]})]})}function X(e){let{message:t,isContinuing:a,isLoading:n,isStreaming:r}=e,{submit:l}=(0,m.e)(),i=(0,P.N)("promptForm"),[o]=(0,M.Uf)(),c=(null==o?void 0:o.remaining)===0,u=a||n||r;return t&&"assistant"===t.role&&("length"===t.finishReason||a)&&!c?(0,s.jsxs)(y.z,{"aria-label":i("continueGeneratingMessage"),className:"absolute -top-10 right-0 flex w-min items-center",disabled:u,onClick:()=>{Promise.all([l({action:"continue",assistantMessageId:t.id}),(0,d.j)("ContinueMessage",{messageId:t.id})])},size:"sm",children:[u&&(0,s.jsx)(C.$,{size:16}),i("continueGenerating"),(0,s.jsx)("span",{className:"sr-only",children:i("continueGeneratingMessage")})]}):null}function Q(){let e=(0,c.RN)().chatId,{data:t,mutate:a}=(0,Z.ZP)([e,"prompt-form-input"],null);return{promptFormInput:t,setPromptFormInput:(0,r.useCallback)(e=>{a(e)},[a]),chatId:e}}},73884:(e,t,a)=>{a.d(t,{P:()=>l});var s=a(69160),n=a(79995),r=a(59700);let l=n.forwardRef((e,t)=>{let{maxHeight:a=384,minHeight:l=42,className:i,resizeFunctionRef:o,...c}=e,d=(0,n.useRef)(null);n.useImperativeHandle(t,()=>d.current);let m=(0,n.useCallback)(()=>{let e=d.current;if(!e)return;e.style.height="".concat(l,"px");let t=e.scrollHeight;e.style.height="".concat(Math.max(l,Math.min(t,a)),"px")},[a,l]);return n.useImperativeHandle(o,()=>m),(0,n.useEffect)(()=>(m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)),[m]),(0,s.jsx)("textarea",{...c,className:(0,r.cn)("resize-none overflow-auto",i),"data-1p-ignore":!0,"data-dashlane-disabled-on-field":!0,onChange:e=>{var t;m(),null===(t=c.onChange)||void 0===t||t.call(c,e)},ref:d,style:{...c.style,minHeight:"".concat(l,"px"),maxHeight:"".concat(a,"px")}})});l.displayName="ResizableTextArea"},43359:(e,t,a)=>{a.d(t,{Ol:()=>i,SZ:()=>c,Zb:()=>l,aY:()=>d,eW:()=>m,ll:()=>o});var s=a(69160),n=a(79995),r=a(59700);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("shadow-base bg-background-subtle rounded-lg",a),ref:t,...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("grid gap-4",a),ref:t,...n})});i.displayName="CardHeader",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("bg-background mb-4 flex h-8 w-8 items-center justify-center rounded-lg border [&>svg]:size-4",a),ref:t,...n})}).displayName="CardIcon";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("h3",{className:(0,r.cn)("whitespace-nowrap font-medium leading-none tracking-tight",a),ref:t,...n})});o.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("p",{className:(0,r.cn)("text-muted-foreground text-sm",a),ref:t,...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("p-6 pt-0",a),ref:t,...n})});d.displayName="CardContent";let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)(" flex items-center p-6 pt-0",a),ref:t,...n})});m.displayName="CardFooter"},15794:(e,t,a)=>{a.d(t,{di:()=>p,e8:()=>d,fu:()=>u,mY:()=>o,rb:()=>m,sZ:()=>c});var s=a(69160),n=a(79995),r=a(89834),l=a(59700),i=a(93419);let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.mY,{className:(0,l.cn)("bg-background flex size-full flex-col overflow-hidden rounded-xl text-gray-900",a),ref:t,...n})});o.displayName=r.mY.displayName;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-3 border-b px-4","cmdk-input-wrapper":"",children:[(0,s.jsx)(i.Y,{className:"size-4 shrink-0 !text-gray-500"}),(0,s.jsx)(r.mY.Input,{className:(0,l.cn)("flex h-12 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-gray-400 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})]})});c.displayName=r.mY.Input.displayName;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.mY.List,{className:(0,l.cn)("max-h-[300px] scroll-py-1.5 overflow-y-auto overflow-x-hidden",a),ref:t,...n})});d.displayName=r.mY.List.displayName;let m=n.forwardRef((e,t)=>(0,s.jsx)(r.mY.Empty,{className:"py-6 text-center text-sm",ref:t,...e}));m.displayName=r.mY.Empty.displayName;let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.mY.Group,{className:(0,l.cn)("overflow-hidden px-1.5 py-2 text-gray-500 [&_[cmdk-group-heading]]:p-2 [&_[cmdk-group-heading]]:text-[0.8125rem] [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-gray-500",a),ref:t,...n})});u.displayName=r.mY.Group.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.mY.Separator,{className:(0,l.cn)("bg-alpha-400 h-px",a),ref:t,...n})}).displayName=r.mY.Separator.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.mY.Item,{className:(0,l.cn)("relative flex w-full cursor-pointer select-none items-center gap-3 rounded-md px-2 py-2.5 text-sm text-gray-900 outline-none transition-colors aria-selected:bg-gray-100 data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&>svg]:size-4 [&>svg]:transition-colors [&[data-selected=true]_[cmdk-item-actions]]:visible",a),ref:t,...n})});p.displayName=r.mY.Item.displayName},80729:(e,t,a)=>{a.d(t,{Er:()=>c,HY:()=>l,T1:()=>d,tL:()=>o,z1:()=>i});var s=a(69160),n=a(79995),r=a(59700);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex items-center justify-center",a),ref:t,...n})});l.displayName="Empty";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col items-center gap-4 text-center",a),ref:t,...n})});i.displayName="EmptyContent";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("shadow-base bg-background flex size-8 items-center justify-center rounded-sm text-gray-500 [&>svg]:size-4 [&>svg]:!text-gray-500",a),ref:t,...n})});o.displayName="EmptyIcon";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("text-base font-medium",a),ref:t,...n})});c.displayName="EmptyTitle";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{className:(0,r.cn)("-mt-2 text-sm text-gray-500",a),ref:t,...n})});d.displayName="EmptyDescription"},39929:(e,t,a)=>{a.d(t,{Z:()=>b});var s=a(79995),n=a(94835),r=a(97077),l=a(52758),i=a(1973),o=a(14905);let c=(0,a(9509).$)("0a3a29631dd0a034a33f73cb0b74720fb76fc20b");var d=a(80685),m=a(76891),u=a(43097),p=a(59210),h=a(15317),x=a(10556),g=a(85784),f=a(28778),v=a(98985),y=a(30758);let j=e=>new Promise((t,a)=>{let s=new Image;s.onload=()=>{t({width:s.naturalWidth,height:s.naturalHeight})},s.onerror=()=>{a(Error("Failed to load image"))},s.src=URL.createObjectURL(e)}),b=e=>{let{isSignedIn:t,dragContainerRef:a,projectId:b,onFinish:w,onSuccess:k,onUploadStart:C,disablePaste:z}=e,E=b?"project-source":"prompt-attachment",{draft:Z}=(0,u.no)(),I=(0,s.useRef)(null),[P,F]=(0,s.useState)(!1),[S,M]=(0,s.useState)((null==Z?void 0:Z.source)==="cookie"&&Z.localFileInfos||[]),{user:D,activeScopeSlug:R,isTeam:L}=(0,v.PK)(),A=(0,h.b)(),{revalidate:T}=(0,d.v)(),[O,Y]=(0,s.useState)(!1),H=(0,o.useRouter)(),{setShowSignInDialog:U}=(0,n.p)(),[B,W]=(0,s.useState)(new Map),{handleSavePromptDraft:q}=(0,u.no)();(0,s.useEffect)(()=>{(null==Z?void 0:Z.source)!=="cookie"&&(M((null==Z?void 0:Z.localFileInfos)||[]),W(new Map(Object.entries((null==Z?void 0:Z.fileMap)||{}))))},[Z]);let V=(0,s.useCallback)(async e=>{try{if(!t){U({prompt:!1});return}if(B.size+e.length>y.Vr[E]){r.Am.error("You can only upload up to ".concat(y.Vr[E]," files"));return}F(!0);let s=[],n=[];async function a(e){var t,a;let o,d;let u=(0,g.sE)();if(e.name.startsWith(i.s)&&(null==D?void 0:D.isAdminMode)&&!b){let t=await c({payload:{file:e}});return"error"in t?{status:"error",message:t.error}:(T(),r.Am.success("Chat imported successfully"),H.push("/chat/".concat(t.chatId)),{status:"success"})}if((0,m.FX)(e.type)){let t=A.image.maxSizeBytes;if(e.size>t)return{status:"error",message:"".concat(e.name," is larger than ").concat((0,m.BT)(t))};let a=await j(e),{short:s,long:n}=A.image.maxDimensionsPixels,r=Math.max(a.width||0,a.height||0),l=Math.min(a.width||0,a.height||0);if(r>n||l>s)return{status:"error",message:"".concat(e.name," exceeds the maximum dimensions. Long side must be less than or equal to ").concat(n,"px and short side must be less than or equal to ").concat(s,"px.")}}(0,m.Ld)(e.type,e.name.split(".").pop())&&(o=await e.text());let h=e.type.startsWith("image/")?(0,p.gw)(e):(0,p.f8)(o||""),v={id:u,name:e.name,url:URL.createObjectURL(e),content:o,status:"uploading",size:e.size,isImage:e.type.startsWith("image/"),tokens:h};M(e=>[...e,v]),null==C||C(v);let y={component:E,fileType:e.type,extension:null===(t=e.name.split(".").pop())||void 0===t?void 0:t.toLowerCase(),scopeSlug:L?R:void 0};try{d=await (0,l.ws)(e.name,e,{access:"public",handleUploadUrl:"/chat/api/chat/upload",clientPayload:JSON.stringify(y)})}catch(a){(0,x.j)("FileUploadError",{fileName:e.name,fileType:e.type,errorMsg:String(a)}),console.error("Failed to upload ".concat(e.name,": ").concat(String(a))),M(e=>e.filter(e=>e.id!==u));let t="Failed to upload file "+e.name;return a instanceof f.Dt&&(t="File type not allowed"),{status:"error",message:t}}if(b){(0,x.j)("UploadSource",{projectId:b,extension:null===(a=e.name.split(".").pop())||void 0===a?void 0:a.toLowerCase(),type:e.type});let t={projectId:b,filename:e.name,url:d.url,scope:R},s=await fetch("/chat/api/projects/sources",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});if(!s.ok){let e;try{e=(await s.json()).error}catch(t){e="Failed to start file indexing"}return{status:"error",message:e}}}let N={...d,name:e.name,size:e.size};return M(e=>{let t=e.map(e=>e.id===u?{...e,status:"done"}:e);return q({localFileInfos:t.map(e=>({...e,isSavedDraft:!0}))}),t}),n.push(N),W(e=>{let t=new Map(e).set(u,N);return q({fileMap:Object.fromEntries(t)}),t}),s.push(v),{status:"success"}}let o=await Promise.allSettled(e.map(a)),d=!1;for(let e of o){if("rejected"===e.status){d=!0,r.Am.error("Failed to upload file");continue}if("error"===e.value.status){d=!0,r.Am.error(e.value.message);continue}}d||null==k||k()}catch(e){r.Am.error("Unexpected error while uploading files")}F(!1),null==w||w()},[w,t,B.size,E,U,null==D?void 0:D.isAdminMode,b,C,L,R,T,H,A.image.maxSizeBytes,A.image.maxDimensionsPixels,q,k]),$=(0,s.useCallback)(async e=>{if(Y(!1),P||(e.preventDefault(),e.stopPropagation(),!e.dataTransfer))return;if(!t){U({prompt:!1});return}let{files:a,items:s}=e.dataTransfer,n=s?await N(Array.from(s)):await N(Array.from(a));n.ok&&await V(n.value)},[t,U,V,P,Y]);(0,s.useEffect)(()=>{if(z)return;let e=async e=>{if(e.clipboardData){let t=e.clipboardData.items,a=[],s=async()=>{for(let e of t)if("file"===e.kind){let t=e.getAsFile();if(t){if((0,m.FX)(t.type)){let e=A.image.maxSizeBytes;if(t.size>e){r.Am.error("".concat(t.name," is larger than ").concat((0,m.BT)(e)));return}}a.push(t)}}a.length>0&&await V(a)};await s()}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}},[A.image.maxSizeBytes,t,U,V,z]),(0,s.useEffect)(()=>{let e=document.documentElement,t=(null==a?void 0:a.current)||window,s=()=>{Y(!0)},n=()=>{Y(!1)},r=e=>{e.preventDefault(),e.stopPropagation()};return t.addEventListener("dragenter",s),e.addEventListener("mouseleave",n),t.addEventListener("dragover",r),t.addEventListener("drop",$),()=>{t.removeEventListener("dragenter",s),e.removeEventListener("mouseleave",n),t.removeEventListener("dragover",r),t.removeEventListener("drop",$)}},[$,a]);let _=async e=>{if(!e.target.files)return;let t=await N(Array.from(e.target.files));t.ok&&(await V(t.value),e.target.value="")};return{blobs:Array.from(B.values()),reset:()=>{M([]),W(new Map),q({localFileInfos:[],fileMap:{}})},uploading:P,localFileInfos:S,isDraggingFile:O,inputFileRef:I,onInputChange:_,removeFile:e=>{M(t=>{let a=t.filter(t=>t.id!==e);return q({localFileInfos:a}),a}),W(t=>{let a=new Map(t);return a.delete(e),q({fileMap:Object.fromEntries(a)}),a})},uploadFiles:V}};async function N(e){let t=[];if(!(null==e?void 0:e.length))return{ok:!1};let a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e.isFile)return[await new Promise(t=>e.file(t))];if(e.isDirectory){let s=e.createReader(),n=await new Promise(e=>s.readEntries(e));return(await Promise.all(n.map(s=>a(s,t+e.name+"/")))).flat()}return[]},s=[];for(let a of e)if("webkitGetAsEntry"in a){let e=a.webkitGetAsEntry();e&&s.push(e)}else t.push(a);for(let e of s){let s=await a(e);t.push(...s)}let n=[];for(let e=0;e<t.length;e++){var l;let a=null===(l=t[e].name.split(".").pop())||void 0===l?void 0:l.toLowerCase();if(".DS_Store"!==t[e].name){if(!a)return r.Am.error("Unsupported file type "+a),{ok:!1};n.push(t[e])}}return{ok:!0,value:n}}(0,s.createContext)({hasUploadedFiles:!1,isUploadingFiles:!1})},89292:(e,t,a)=>{a.d(t,{N:()=>r});var s=a(59210),n=a(76891);function r(e){for(let t=e.length-1;t>=0;t--)if("usage"in e[t]&&e[t].usage)return e[t].usage.totalTokens;return e.reduce((e,t)=>{if("attachments"in t){var a;null===(a=t.attachments)||void 0===a||a.forEach(t=>{var a;let s=t.contentType;s&&(0,n.FX)(s)?e+=1600:(s&&(0,n.Ld)(s,null===(a=t.name)||void 0===a?void 0:a.split(".").pop()),e+=1e3)})}let r="string"==typeof t.content?t.content:"";return e+(0,s.f8)(r)},0)}},76891:(e,t,a)=>{function s(e){return e.startsWith("image/")&&!e.includes("svg")}function n(e){return(e/1048576).toFixed(2).replace(/\.?0+$/,"")+"MB"}a.d(t,{BT:()=>n,FX:()=>s,Ld:()=>i});let r=["text/plain","text/markdown","text/html","application/json","text/csv","text/x-python","application/typescript","text/tsx","text/jsx","text/markdown","text/html","text/css","application/yaml","application/yml","application/sql","application/x-sql","application/xml"],l=["txt","md","json","csv","py","ts","tsx","js","jsx","log","html","css","yml","yaml","mermaid","mjs","mts","sql","map","xml"];function i(e,t){return r.includes(e)||l.includes(t)}},59210:(e,t,a)=>{a.d(t,{Yd:()=>r,f8:()=>n,gw:()=>l});let s={"claude-3-5-sonnet-20240620":3.2,"anthropic.claude-3-5-sonnet-20240620-v1:0":3.2,"us.anthropic.claude-3-5-sonnet-20240620-v1:0":3.2,"meta.llama3-8b-instruct-v1:0":4,"llama3-70b-8192":4.5,"meta.llama3-70b-instruct-v1:0":4,"gpt-4o-mini":4,default:4};function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anthropic.claude-3-5-sonnet-20240620-v1:0",a=s[t]||s.default;return Math.round(.9*Math.ceil(("string"==typeof e?e.trim().length:e.charCount)/a))}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"anthropic.claude-3-5-sonnet-20240620-v1:0";return Math.round(e*(s[t]||s.default)*(1/.9))}function l(e){return Math.round(1334*(("number"==typeof e?e:e.size)/1048576))}},23390:(e,t,a)=>{a.d(t,{g:()=>s});let s=(0,a(9509).$)("24d7778ecd5789cbe668705bed2dc481bcfc7ff9")},69512:(e,t,a)=>{a.d(t,{m:()=>s});let s=(0,a(9509).$)("37ea309b69a5d785fe66d4355562f091c94ae5b0")}}]);