(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1765,2118],{81652:(e,t,r)=>{"use strict";r.d(t,{PixelIcon:()=>f});var n=r(69160),o=r(31281),i=r(79995);let s=(0,i.createContext)(void 0),l={setTheme:e=>{},themes:[]},a=()=>{var e;return null!==(e=(0,i.useContext)(s))&&void 0!==e?e:l};var c=r(31203),u=r.n(c);function f(e){let{label:t,...r}=e,s=(0,i.useRef)(null),[l,c]=(0,i.useState)(!1),{resolvedTheme:f}=a();(0,i.useEffect)(()=>{if(!s.current||!r.useCanvas)return;c(!0);let{start:e,stop:t}=function(e){let{color:t,colorSecondary:r,pixelMatrix:n,canvas:o,active:i,renderScale:s=2,transitionSpeed:l=1,theme:a}=e;performance.now();let c=0,u=!1,f=0,h=[],d=[],y=[];for(let e=0;e<n.length;e++){h[e]=[],d[e]=[],y[e]=[];for(let t=0;t<n[e].length;t++)h[e][t]=Math.random(),d[e][t]=w(Math.random(),.1,.9),y[e][t]=0}let m=.1*l,g="dark"===a?"#ffffff":"#000000",x=p(g),v=p(t||g),b=r?p(r):v,_=r?1:.5;function w(e,t,r){return e<=t?t:e>=r?r:e}function E(){if(performance.now(),c=requestAnimationFrame(E),!(null==i?void 0:i.current)&&0===f&&u)return;let e=o.getContext("2d");if(!e)return;let t=Math.ceil(performance.now()/100),r=o.clientWidth*s,l=o.clientHeight*s;o.width=r,o.height=l;let a=Math.min(r/n[0].length,l/n.length);e.clearRect(0,0,r,l),f=0;for(let r=0;r<n.length;r++)for(let o=0;o<n[r].length;o++){var p,g,j;let s;let l=h[r][o],c=d[r][o],u=w(.5*Math.sin(t*l)+1,0,1),E=y[r][o];E>f&&(f=E),y[r][o]=(null==i?void 0:i.current)?Math.min(E+m*c,1):Math.max(E-m*c,0);let I={color:w(2*E,0,1),alpha:E},R=v.map(e=>{var t,r;return t=x[0],(1-(r=I.color))*t+r*e}),N=b.map(e=>{var t,r;return t=x[0],(1-(r=I.color))*t+r*e}),T=(1-(g=I.color))*0+1*g,A=(1-(j=I.alpha))*1+j*u,C="".concat(R[0],",").concat(R[1],",").concat(R[2]),k="".concat(N[0],",").concat(N[1],",").concat(N[2]),S="".concat(255,",",255,",",255);switch(null===(p=n[r])||void 0===p?void 0:p[o]){case 1:s="rgba(".concat(C,",").concat(A,")");break;case 2:s="rgba(".concat(k,",").concat(A*_,")");break;case 3:s="rgba(".concat(S,", ").concat(2*A*T,")");break;default:continue}e.beginPath(),e.arc(o*a+a/2,r*a+a/2,a/2,0,2*Math.PI),e.fillStyle=s,e.fill()}u=!0}return{start:()=>requestAnimationFrame(E),stop:()=>cancelAnimationFrame(c)}}({...r,theme:f,active:r.active||{current:!1},canvas:s.current});return e(),()=>{t()}},[f,r]);let{path1s:h,path2s:d}=function(e){let t="",r="";if(!e[0])return{path1s:t,path2s:r};let n=1/e[0].length,o=1/e.length,i=s(Math.min(n,o)/2);function s(e){return Math.round(1e4*e)/1e4}function l(e,t){let r=s(t*n+n/2),l=s(e*o+o/2);return""+("M".concat(r," ").concat(l," ")+"m".concat(-i,",0 ")+"a".concat(i,",").concat(i," 0 1,0 ").concat(s(2*i),",0 ")+"a".concat(i,",").concat(i," 0 1,0 ").concat(s(-(2*i)),",0 "))}return e.forEach((e,n)=>e.forEach((e,o)=>{switch(e){case 1:t+=l(n,o);break;case 2:r+=l(n,o)}})),{path1s:t,path2s:r}}(r.pixelMatrix);return(0,n.jsxs)("div",{"aria-label":t,className:(0,o.W)(u().container,r.className,{[u().usingCanvas]:l}),role:"img",children:[(0,n.jsxs)("svg",{viewBox:"0 0 1 1",children:[(0,n.jsx)("path",{d:h,fill:"var(--ds-gray-1000)"}),(0,n.jsx)("path",{d:d,fill:"var(--ds-gray-1000)",opacity:.5})]}),(0,n.jsx)("canvas",{ref:s,style:{maxWidth:"100%",maxHeight:"100%"}})]})}function p(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.replace("0x","#"));return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[0,0,0]}},59667:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});let n=(0,r(68030).l)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 1.75V1H7.25V1.75V6.75H2.25H1.5V8.25H2.25H7.25V13.25V14H8.75V13.25V8.25H13.75H14.5V6.75H13.75H8.75V1.75Z" fill="currentColor"/>')},44246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{useAwaitPaintSelectState:()=>i});var n=r(79995);function o(){return new Promise(e=>{setTimeout(e,100),requestAnimationFrame(()=>{setTimeout(e,0)})})}function i(e){let{onChange:t}=e,[r,i]=(0,n.useState)(!1);function s(){(async()=>{await o(),i(e=>!e)})()}function l(){(async()=>{await o(),i(!1)})()}function a(e){(async()=>{await o(),t(e)})()}return{open:r,onTrigger:s,onSelect:l,onValueChange:a,awaitPaintTriggerProps:{onClick:e=>{e.currentTarget.focus()},onKeyDown:e=>{"Enter"===e.key&&(s(),r&&e.preventDefault())},onTouchStart:s,onPointerDown:e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),0!==e.button||e.ctrlKey||(s(),e.preventDefault())}},awaitPaintItemProps:{onClick:l,onKeyDown:e=>{"Enter"===e.key&&l(),"Escape"===e.key&&s()},onTouchStart:l},awaitPaintRootProps:{onValueChange:a,open:r}}}},61812:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(79995);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enterDelay:0,exitDelay:0},[r,o]=(0,n.useState)(e),[i,s]=(0,n.useState)(!1),l=(0,n.useRef)(),a=(0,n.useRef)(null),c=(0,n.useRef)(t);return(0,n.useEffect)(()=>{c.current=t},[t]),(0,n.useEffect)(()=>{clearTimeout(l.current);let{enterDelay:t,exitDelay:r,onUnmount:n}=c.current;if(e)a.current=Date.now(),o(!0),-1===t?"requestIdleCallback"in window?window.requestIdleCallback(()=>{s(!0)},{timeout:100}):setTimeout(()=>{s(!0)},1):0===t?s(!0):l.current=window.setTimeout(()=>{s(!0)},t);else{s(!1);let e=r;if(a.current){let n=Date.now()-a.current;t&&n<t?e=0:r&&n<r&&(e=n)}0===e?(o(!1),a.current&&(null==n||n())):l.current=setTimeout(()=>{o(!1),a.current&&(null==n||n())},e)}},[e]),{mounted:r,rendered:i}}},73332:(e,t,r)=>{"use strict";r.r(t),r.d(t,{useIsomorphicLayoutEffect:()=>o});var n=r(79995);let o="undefined"!=typeof window?n.useLayoutEffect:n.useEffect},52451:(e,t,r)=>{"use strict";r.r(t),r.d(t,{useIsMobile:()=>s,useIsTablet:()=>l,useMediaQuery:()=>i});var n=r(79995);let o=!1,i=(e,t)=>{let r=["(max-width: ".concat(e,"px)").concat(null!=t?",":""),null!=t?"(max-height: ".concat(t,"px)"):null].filter(Boolean).join(" "),[i,s]=(0,n.useState)(()=>o?window.innerWidth<=e||void 0!==t&&window.innerHeight<=t:void 0),l=(0,n.useRef)(i);return(0,n.useEffect)(()=>{l.current=i},[i]),(0,n.useEffect)(()=>{let n=()=>{s(i.matches)};void 0===l.current&&s(window.innerWidth<=e||void 0!==t&&window.innerHeight<=t),o=!0;let i=window.matchMedia(r);return i.addEventListener("change",n),i.matches&&s(!0),()=>{i.removeEventListener("change",n)}},[e,t,r]),i},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;return i(e)},l=()=>i(960)},2009:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BlurBase64:()=>s,BlurBase64Context:()=>o,withBlurBase64:()=>i});var n=r(69160);let o=(0,r(79995).createContext)(null),i=e=>t=>{let{...r}=t;return(0,n.jsx)(o.Provider,{value:r.blurBase64DataURLs,children:(0,n.jsx)(e,{...r})})};function s(e){let{blurBase64DataURLs:t,children:r}=e;return(0,n.jsx)(o.Provider,{value:t,children:r})}},31281:(e,t,r)=>{"use strict";function n(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=function e(t){var r,n,o="";if("string"==typeof t||"number"==typeof t)o+=t;else if("object"==typeof t){if(Array.isArray(t))for(r=0;r<t.length;r++)t[r]&&(n=e(t[r]))&&(o&&(o+=" "),o+=n);else for(r in t)t[r]&&(o&&(o+=" "),o+=r)}return o}(e))&&(n&&(n+=" "),n+=t);return n}r.d(t,{W:()=>n})},55699:(e,t,r)=>{"use strict";var n=r(86518).lW;let o=void 0!==n,i=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function l(e,t,r){null==r&&null!==t&&"object"==typeof t&&(r=t,t=void 0),o&&n.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let l=JSON.parse(e,t);if(null===l||"object"!=typeof l)return l;let c=r&&r.protoAction||"error",u=r&&r.constructorAction||"error";if("ignore"===c&&"ignore"===u)return l;if("ignore"!==c&&"ignore"!==u){if(!1===i.test(e)&&!1===s.test(e))return l}else if("ignore"!==c&&"ignore"===u){if(!1===i.test(e))return l}else if(!1===s.test(e))return l;return a(l,{protoAction:c,constructorAction:u,safe:r&&r.safe})}function a(e,{protoAction:t="error",constructorAction:r="error",safe:n}={}){let o=[e];for(;o.length;){let e=o;for(let i of(o=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===n)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===n)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let e in i){let t=i[e];t&&"object"==typeof t&&o.push(t)}}}return e}function c(e,t,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return l(e,t,r)}finally{Error.stackTraceLimit=n}}e.exports=c,e.exports.default=c,e.exports.parse=c,e.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return l(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},e.exports.scan=a},31203:e=>{e.exports={container:"pixel-icon_container__q0Y02",usingCanvas:"pixel-icon_usingCanvas__Snzg0"}},32167:(e,t,r)=>{"use strict";r.d(t,{bF:()=>o,Ox:()=>i});let n=(e,t=21)=>(r=t)=>{let n="",o=r;for(;o--;)n+=e[Math.random()*e.length|0];return n};r(55699),r(92104);var o=({prefix:e="",size:t=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{let o=n(r,t);return t=>`${e}${o(t)}`},i=o();Symbol.for("vercel.ai.validator");var{btoa:s,atob:l}=globalThis},34802:(e,t,r)=>{"use strict";r.d(t,{AX:()=>c,A_:()=>x,JJ:()=>d,e$:()=>u});var n,o,i,s="vercel.ai.error",l=Symbol.for(s),a=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[n]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,s)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}toJSON(){return{name:this.name,message:this.message}}};n=l;var c=a;function u(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}Symbol.for("vercel.ai.error.AI_APICallError"),Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError"),Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError"),Symbol.for("vercel.ai.error.AI_JSONParseError"),Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var f="AI_NoSuchModelError",p=`vercel.ai.error.${f}`,h=Symbol.for(p),d=class extends c{constructor({errorName:e=f,modelId:t,modelType:r,message:n=`No such ${r}: ${t}`}){super({name:e,message:n}),this[o]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return c.hasMarker(e,p)}static isNoSuchModelError(e){return e instanceof Error&&e.name===f&&"string"==typeof e.modelId&&"string"==typeof e.modelType}toJSON(){return{name:this.name,message:this.message,stack:this.stack,modelId:this.modelId,modelType:this.modelType}}};o=h,Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError"),Symbol.for("vercel.ai.error.AI_TypeValidationError");var y="AI_UnsupportedFunctionalityError",m=`vercel.ai.error.${y}`,g=Symbol.for(m),x=class extends c{constructor({functionality:e}){super({name:y,message:`'${e}' functionality not supported.`}),this[i]=!0,this.functionality=e}static isInstance(e){return c.hasMarker(e,m)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===y&&"string"==typeof e.functionality}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};function v(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(v):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&v(t)))}i=g},44135:(e,t,r)=>{"use strict";r.d(t,{vl:()=>E}),r(55699),Symbol("Let zodToJsonSchema decide on which parser to use");let n=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};var o={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},i={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},s={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},l={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},a={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},c={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},u={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},f={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some(e=>null==e||"object"!=typeof e||!("id"in e)||"string"!=typeof e.id||!("type"in e)||"string"!=typeof e.type||!("function"in e)||null==e.function||"object"!=typeof e.function||!("arguments"in e.function)||"string"!=typeof e.function.name||"string"!=typeof e.function.arguments))throw Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},p={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},h={code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},d={code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},y={code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},m={code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},g={code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},x={code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_step",value:t}}},v=[o,i,s,l,a,c,u,f,p,h,d,y,m,g,x],b={[o.code]:o,[i.code]:i,[s.code]:s,[l.code]:l,[a.code]:a,[c.code]:c,[u.code]:u,[f.code]:f,[p.code]:p,[h.code]:h,[d.code]:d,[y.code]:y,[m.code]:m,[g.code]:g,[x.code]:x};o.name,o.code,i.name,i.code,s.name,s.code,l.name,l.code,a.name,a.code,c.name,c.code,u.name,u.code,f.name,f.code,p.name,p.code,h.name,h.code,d.name,d.code,y.name,y.code,m.name,m.code,g.name,g.code,x.name,x.code;var _=v.map(e=>e.code),w=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let r=e.slice(0,t);if(!_.includes(r))throw Error(`Failed to parse stream string. Invalid code ${r}.`);let n=JSON.parse(e.slice(t+1));return b[r].parse(n)};function E(e,t){let r=v.find(t=>t.name===e);if(!r)throw Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}
`}Symbol.for("vercel.ai.schema")},68612:(e,t,r)=>{"use strict";r.d(t,{Ue:()=>F});class n{constructor(e){this.selfOptions=e||{},this.pipes={}}options(e){return e&&(this.selfOptions=e),this.selfOptions}pipe(e,t){let r=t;if("string"==typeof e){if(void 0===r)return this.pipes[e];this.pipes[e]=r}if(e&&e.name){if((r=e).processor===this)return r;this.pipes[r.name]=r}return r.processor=this,r}process(e,t){let r,n=e;n.options=this.options();let o=t||e.pipe||"default";for(;o;)void 0!==n.nextAfterChildren&&(n.next=n.nextAfterChildren,n.nextAfterChildren=null),"string"==typeof o&&(o=this.pipe(o)),o.process(n),r=o,o=null,n&&n.next&&(o=(n=n.next).pipe||r);return n.hasResult?n.result:void 0}}class o{constructor(e){this.name=e,this.filters=[]}process(e){if(!this.processor)throw Error("add this pipe to a processor before using it");let t=this.debug,r=this.filters.length;for(let n=0;n<r;n++){let r=this.filters[n];if(t&&this.log(`filter: ${r.filterName}`),r(e),"object"==typeof e&&e.exiting){e.exiting=!1;break}}!e.next&&this.resultCheck&&this.resultCheck(e)}log(e){console.log(`[jsondiffpatch] ${this.name} pipe, ${e}`)}append(...e){return this.filters.push(...e),this}prepend(...e){return this.filters.unshift(...e),this}indexOf(e){if(!e)throw Error("a filter name is required");for(let t=0;t<this.filters.length;t++)if(this.filters[t].filterName===e)return t;throw Error(`filter not found: ${e}`)}list(){return this.filters.map(e=>e.filterName)}after(e,...t){let r=this.indexOf(e);return this.filters.splice(r+1,0,...t),this}before(e,...t){let r=this.indexOf(e);return this.filters.splice(r,0,...t),this}replace(e,...t){let r=this.indexOf(e);return this.filters.splice(r,1,...t),this}remove(e){let t=this.indexOf(e);return this.filters.splice(t,1),this}clear(){return this.filters.length=0,this}shouldHaveResult(e){if(!1===e){this.resultCheck=null;return}if(!this.resultCheck)return this.resultCheck=e=>{if(!e.hasResult){console.log(e);let t=Error(`${this.name} failed`);throw t.noResult=!0,t}},this}}class i{setResult(e){return this.result=e,this.hasResult=!0,this}exit(){return this.exiting=!0,this}push(e,t){return e.parent=this,void 0!==t&&(e.childName=t),e.root=this.root||this,e.options=e.options||this.options,this.children?(this.children[this.children.length-1].next=e,this.children.push(e)):(this.children=[e],this.nextAfterChildren=this.next||null,this.next=e),e.next=this,this}}function s(e){if("object"!=typeof e)return e;if(null===e)return null;if(Array.isArray(e))return e.map(s);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return function(e){let t=/^\/(.*)\/([gimyu]*)$/.exec(e.toString());return new RegExp(t[1],t[2])}(e);let t={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=s(e[r]));return t}class l extends i{constructor(e,t){super(),this.left=e,this.right=t,this.pipe="diff"}setResult(e){if(this.options.cloneDiffValues&&"object"==typeof e){let t="function"==typeof this.options.cloneDiffValues?this.options.cloneDiffValues:s;"object"==typeof e[0]&&(e[0]=t(e[0])),"object"==typeof e[1]&&(e[1]=t(e[1]))}return super.setResult(e)}}class a extends i{constructor(e,t){super(),this.left=e,this.delta=t,this.pipe="patch"}}class c extends i{constructor(e){super(),this.delta=e,this.pipe="reverse"}}let u=function(e){if(e.left===e.right){e.setResult(void 0).exit();return}if(void 0===e.left){if("function"==typeof e.right)throw Error("functions are not supported");e.setResult([e.right]).exit();return}if(void 0===e.right){e.setResult([e.left,0,0]).exit();return}if("function"==typeof e.left||"function"==typeof e.right)throw Error("functions are not supported");if(e.leftType=null===e.left?"null":typeof e.left,e.rightType=null===e.right?"null":typeof e.right,e.leftType!==e.rightType||"boolean"===e.leftType||"number"===e.leftType||("object"===e.leftType&&(e.leftIsArray=Array.isArray(e.left)),"object"===e.rightType&&(e.rightIsArray=Array.isArray(e.right)),e.leftIsArray!==e.rightIsArray)){e.setResult([e.left,e.right]).exit();return}e.left instanceof RegExp&&(e.right instanceof RegExp?e.setResult([e.left.toString(),e.right.toString()]).exit():e.setResult([e.left,e.right]).exit())};u.filterName="trivial";let f=function(e){if(void 0===e.delta){e.setResult(e.left).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;let t=e.delta;if(1===t.length){e.setResult(t[0]).exit();return}if(2===t.length){if(e.left instanceof RegExp){let r=/^\/(.*)\/([gimyu]+)$/.exec(t[1]);if(r){e.setResult(new RegExp(r[1],r[2])).exit();return}}e.setResult(t[1]).exit();return}3===t.length&&0===t[2]&&e.setResult(void 0).exit()};f.filterName="trivial";let p=function(e){if(void 0===e.delta){e.setResult(e.delta).exit();return}if(e.nested=!Array.isArray(e.delta),e.nested)return;let t=e.delta;if(1===t.length){e.setResult([t[0],0,0]).exit();return}if(2===t.length){e.setResult([t[1],t[0]]).exit();return}3===t.length&&0===t[2]&&e.setResult([t[0]]).exit()};p.filterName="trivial";let h=e=>{let t;if(!e||!e.children)return;let r=e.children.length,n=e.result;for(let o=0;o<r;o++)void 0!==(t=e.children[o]).result&&((n=n||{})[t.childName]=t.result);n&&e.leftIsArray&&(n._t="a"),e.setResult(n).exit()};h.filterName="collectChildren";let d=e=>{let t,r;if(e.leftIsArray||"object"!==e.leftType)return;let n=e.left,o=e.right,i=e.options.propertyFilter;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(!i||i(t,e))&&(r=new l(n[t],o[t]),e.push(r,t));for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(!i||i(t,e))&&void 0===n[t]&&(r=new l(void 0,o[t]),e.push(r,t));if(!e.children||0===e.children.length){e.setResult(void 0).exit();return}e.exit()};d.filterName="objects";let y=function(e){let t,r;if(!e.nested)return;let n=e.delta;if(!n._t){for(t in n)r=new a(e.left[t],n[t]),e.push(r,t);e.exit()}};y.filterName="objects";let m=function(e){let t;if(!e||!e.children||e.delta._t)return;let r=e.left,n=e.children.length;for(let o=0;o<n;o++){let n=(t=e.children[o]).childName;Object.prototype.hasOwnProperty.call(e.left,n)&&void 0===t.result?delete r[n]:r[n]!==t.result&&(r[n]=t.result)}e.setResult(r).exit()};m.filterName="collectChildren";let g=function(e){let t,r;if(!e.nested||e.delta._t)return;let n=e.delta;for(t in n)r=new c(n[t]),e.push(r,t);e.exit()};g.filterName="objects";let x=e=>{let t;if(!e||!e.children||e.delta._t)return;let r=e.children.length,n={};for(let o=0;o<r;o++){let r=(t=e.children[o]).childName;n[r]!==t.result&&(n[r]=t.result)}e.setResult(n).exit()};x.filterName="collectChildren";let v=function(e,t,r,n){return e[r]===t[n]},b=function(e,t,r,n){let o,i;let s=e.length,l=t.length,a=Array(s+1);for(o=0;o<s+1;o++)for(i=0,a[o]=Array(l+1);i<l+1;i++)a[o][i]=0;for(o=1,a.match=r;o<s+1;o++)for(i=1;i<l+1;i++)r(e,t,o-1,i-1,n)?a[o][i]=a[o-1][i-1]+1:a[o][i]=Math.max(a[o-1][i],a[o][i-1]);return a},_=function(e,t,r,n){let o=t.length,i=r.length,s={sequence:[],indices1:[],indices2:[]};for(;0!==o&&0!==i;)e.match(t,r,o-1,i-1,n)?(s.sequence.unshift(t[o-1]),s.indices1.unshift(o-1),s.indices2.unshift(i-1),--o,--i):e[o][i-1]>e[o-1][i]?--i:--o;return s},w={get:function(e,t,r,n){let o=n||{};return _(b(e,t,r||v,o),e,t,o)}};function E(e,t,r,n,o){let i=e[r],s=t[n];if(i===s)return!0;if("object"!=typeof i||"object"!=typeof s)return!1;let l=o.objectHash;if(!l)return o.matchByPosition&&r===n;o.hashCache1=o.hashCache1||[];let a=o.hashCache1[r];if(void 0===a&&(o.hashCache1[r]=a=l(i,r)),void 0===a)return!1;o.hashCache2=o.hashCache2||[];let c=o.hashCache2[n];return void 0===c&&(o.hashCache2[n]=c=l(s,n)),void 0!==c&&a===c}let j=function(e){let t,r,n,o,i;if(!e.leftIsArray)return;let s={objectHash:e.options&&e.options.objectHash,matchByPosition:e.options&&e.options.matchByPosition},a=0,c=0,u=e.left,f=e.right,p=u.length,h=f.length;for(p>0&&h>0&&!s.objectHash&&"boolean"!=typeof s.matchByPosition&&(s.matchByPosition=!function(e,t,r,n){for(let o=0;o<r;o++){let r=e[o];for(let e=0;e<n;e++){let n=t[e];if(o!==e&&r===n)return!0}}}(u,f,p,h));a<p&&a<h&&E(u,f,a,a,s);)o=new l(u[t=a],f[t]),e.push(o,t),a++;for(;c+a<p&&c+a<h&&E(u,f,p-1-c,h-1-c,s);)r=p-1-c,n=h-1-c,o=new l(u[r],f[n]),e.push(o,n),c++;if(a+c===p){if(p===h){e.setResult(void 0).exit();return}for(i=i||{_t:"a"},t=a;t<h-c;t++)i[t]=[f[t]];e.setResult(i).exit();return}if(a+c===h){for(i=i||{_t:"a"},t=a;t<p-c;t++)i[`_${t}`]=[u[t],0,0];e.setResult(i).exit();return}delete s.hashCache1,delete s.hashCache2;let d=u.slice(a,p-c),y=f.slice(a,h-c),m=w.get(d,y,E,s),g=[];for(i=i||{_t:"a"},t=a;t<p-c;t++)0>m.indices1.indexOf(t-a)&&(i[`_${t}`]=[u[t],0,0],g.push(t));let x=!0;e.options&&e.options.arrays&&!1===e.options.arrays.detectMove&&(x=!1);let v=!1;e.options&&e.options.arrays&&e.options.arrays.includeValueOnMove&&(v=!0);let b=g.length;for(t=a;t<h-c;t++){let c=m.indices2.indexOf(t-a);if(c<0){let c=!1;if(x&&b>0){for(let p=0;p<b;p++)if(E(d,y,(r=g[p])-a,t-a,s)){i[`_${r}`].splice(1,2,t,3),v||(i[`_${r}`][0]=""),n=t,o=new l(u[r],f[n]),e.push(o,n),g.splice(p,1),c=!0;break}}c||(i[t]=[f[t]])}else r=m.indices1[c]+a,n=m.indices2[c]+a,o=new l(u[r],f[n]),e.push(o,n)}e.setResult(i).exit()};j.filterName="arrays";let I={numerically:(e,t)=>e-t,numericallyBy:e=>(t,r)=>t[e]-r[e]},R=function(e){let t,r,n;if(!e.nested)return;let o=e.delta;if("a"!==o._t)return;let i=e.left,s=[],l=[],c=[];for(t in o)if("_t"!==t){if("_"===t[0]){let e=t;if(0===o[e][2]||3===o[e][2])s.push(parseInt(t.slice(1),10));else throw Error(`only removal or move can be applied at original array indices, invalid diff type: ${o[e][2]}`)}else{let e=t;1===o[e].length?l.push({index:parseInt(e,10),value:o[e][0]}):c.push({index:parseInt(e,10),delta:o[e]})}}for(t=(s=s.sort(I.numerically)).length-1;t>=0;t--){r=s[t];let e=o[`_${r}`],n=i.splice(r,1)[0];3===e[2]&&l.push({index:e[1],value:n})}let u=(l=l.sort(I.numericallyBy("index"))).length;for(t=0;t<u;t++){let e=l[t];i.splice(e.index,0,e.value)}let f=c.length;if(f>0)for(t=0;t<f;t++){let r=c[t];n=new a(i[r.index],r.delta),e.push(n,r.index)}if(!e.children){e.setResult(i).exit();return}e.exit()};R.filterName="arrays";let N=function(e){let t;if(!e||!e.children||"a"!==e.delta._t)return;let r=e.left,n=e.children.length;for(let o=0;o<n;o++)r[(t=e.children[o]).childName]=t.result;e.setResult(r).exit()};N.filterName="arraysCollectChildren";let T=function(e){let t,r;if(!e.nested){let t=e.delta;3===t[2]&&(e.newName=`_${t[1]}`,e.setResult([t[0],parseInt(e.childName.substring(1),10),3]).exit());return}let n=e.delta;if("a"===n._t){for(t in n)"_t"!==t&&(r=new c(n[t]),e.push(r,t));e.exit()}};T.filterName="arrays";let A=(e,t,r)=>{if("string"==typeof t&&"_"===t[0])return parseInt(t.substring(1),10);if(Array.isArray(r)&&0===r[2])return`_${t}`;let n=+t;for(let r in e){let o=e[r];if(Array.isArray(o)){if(3===o[2]){let e=parseInt(r.substring(1),10),i=o[1];if(i===+t)return e;e<=n&&i>n?n++:e>=n&&i<n&&n--}else 0===o[2]?parseInt(r.substring(1),10)<=n&&n++:1===o.length&&parseInt(r,10)<=n&&n--}}return n},C=e=>{let t;if(!e||!e.children)return;let r=e.delta;if("a"!==r._t)return;let n=e.children.length,o={_t:"a"};for(let i=0;i<n;i++){let n=(t=e.children[i]).newName;void 0===n&&(n=A(r,t.childName,t.result)),o[n]!==t.result&&(o[n]=t.result)}e.setResult(o).exit()};C.filterName="arraysCollectChildren";let k=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};k.filterName="dates";let S=null;function O(e,t){var r;if(!S){let n;if(null===(r=null==e?void 0:e.textDiff)||void 0===r?void 0:r.diffMatchPatch)n=new e.textDiff.diffMatchPatch;else{if(!t)return null;let e=Error("The diff-match-patch library was not provided. Pass the library in through the options or use the `jsondiffpatch/with-text-diffs` entry-point.");throw e.diff_match_patch_not_found=!0,e}S={diff:function(e,t){return n.patch_toText(n.patch_make(e,t))},patch:function(e,t){let r=n.patch_apply(n.patch_fromText(t),e);for(let e=0;e<r[1].length;e++)r[1][e]||(Error("text patch failed").textPatchFailed=!0);return r[0]}}}return S}let P=function(e){if("string"!==e.leftType)return;let t=e.left,r=e.right,n=e.options&&e.options.textDiff&&e.options.textDiff.minLength||60;if(t.length<n||r.length<n){e.setResult([t,r]).exit();return}let o=O(e.options);if(!o){e.setResult([t,r]).exit();return}let i=o.diff;e.setResult([i(t,r),0,2]).exit()};P.filterName="texts";let M=function(e){if(e.nested)return;let t=e.delta;if(2!==t[2])return;let r=O(e.options,!0).patch;e.setResult(r(e.left,t[0])).exit()};M.filterName="texts";let $=function(e){let t,r,n,o;let i=null,s=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,l=e.split("\n");for(t=0,r=l.length;t<r;t++){let e=(n=l[t]).slice(0,1);"@"===e?(i=s.exec(n),l[t]="@@ -"+i[3]+","+i[4]+" +"+i[1]+","+i[2]+" @@"):"+"===e?(l[t]="-"+l[t].slice(1),"+"===l[t-1].slice(0,1)&&(o=l[t],l[t]=l[t-1],l[t-1]=o)):"-"===e&&(l[t]="+"+l[t].slice(1))}return l.join("\n")},D=function(e){if(e.nested)return;let t=e.delta;2===t[2]&&e.setResult([$(t[0]),0,2]).exit()};D.filterName="texts";class H{constructor(e){this.processor=new n(e),this.processor.pipe(new o("diff").append(h,u,k,P,d,j).shouldHaveResult()),this.processor.pipe(new o("patch").append(m,N,f,M,y,R).shouldHaveResult()),this.processor.pipe(new o("reverse").append(x,C,p,D,g,T).shouldHaveResult())}options(e){return this.processor.options(e)}diff(e,t){return this.processor.process(new l(e,t))}patch(e,t){return this.processor.process(new a(e,t))}reverse(e){return this.processor.process(new c(e))}unpatch(e,t){return this.patch(e,this.reverse(t))}clone(e){return s(e)}}function F(e){return new H(e)}}}]);